# APIS Development Environment Variables
# Copy this file to .env and fill in your values
#
# =============================================================================
# SECURITY WARNING
# =============================================================================
# This file contains PLACEHOLDER values that MUST be changed before use.
# Replace all <generate-...> placeholders with secure, randomly generated values.
#
# To generate secure passwords, use one of:
#   openssl rand -base64 32
#   pwgen -s 32 1
#   python -c "import secrets; print(secrets.token_urlsafe(24))"
#
# NEVER commit your .env file to version control!
# =============================================================================

# =============================================================================
# SECRETS SOURCE
# =============================================================================
# Where to read secrets from: "openbao" (default) or "env" (fallback)
SECRETS_SOURCE=openbao

# =============================================================================
# OPENBAO CONFIGURATION
# =============================================================================
# For local isolated dev: use defaults (connects to local OpenBao in docker-compose)
# For external OpenBao: set these to your existing OpenBao instance
#
# Example for external OpenBao:
#   OPENBAO_ADDR=https://openbao.yourdomain.com:8200
#   OPENBAO_TOKEN=hvs.your-actual-token
#   OPENBAO_SECRET_PATH=secret/data/apis
#
OPENBAO_ADDR=http://openbao:8200
# SECURITY: Generate a unique token for each environment
OPENBAO_TOKEN=<generate-openbao-token-min-32-chars>
OPENBAO_SECRET_PATH=secret/data/apis
# SECURITY: Dev token should also be unique per developer machine
OPENBAO_DEV_TOKEN=<generate-dev-token-min-32-chars>

# =============================================================================
# FALLBACK: Direct Environment Variables
# =============================================================================
# Used when SECRETS_SOURCE=env or as fallback if OpenBao is unavailable
# For production, these should come from OpenBao instead

# Database (YugabyteDB)
# Admin credentials used by the `yugabytedb-init` container.
# SECURITY: Change these from defaults in any non-local environment
YSQL_USER=yugabyte
YSQL_PASSWORD=<generate-yugabyte-admin-password-min-16-chars>
YSQL_DB=yugabyte

# APIS application DB role (used by `apis-server`)
# SECURITY: These MUST be changed from defaults for any non-local deployment
APIS_DB_USER=apis
APIS_DB_PASSWORD=<generate-apis-db-password-min-16-chars>

# Zitadel Identity Provider
# Note: Zitadel uses dedicated PostgreSQL due to stored procedure compatibility issues
# with YugabyteDB. See https://github.com/zitadel/zitadel/discussions/8840
# MASTERKEY must be EXACTLY 32 characters - use: openssl rand -base64 24 | head -c 32
ZITADEL_MASTERKEY=<generate-exactly-32-character-key>
# SECURITY: Use a strong password (min 12 chars, mixed case, numbers, symbols)
ZITADEL_ADMIN_PASSWORD=<generate-admin-password-min-12-chars>
# ZITADEL_ISSUER should match the issuer claim in tokens (browser-visible URL).
ZITADEL_ISSUER=http://localhost:8080
# ZITADEL_DISCOVERY_URL is used by `apis-server` inside Docker to fetch discovery/JWKS.
ZITADEL_DISCOVERY_URL=http://zitadel:8080

# ZITADEL_CLIENT_ID is the application's client ID in Zitadel.
# Local dev: generated automatically by docker-compose (`zitadel-bootstrap`) and injected at runtime.
# Shared infra/prod: set this to the Client ID from the Zitadel console.
ZITADEL_CLIENT_ID=
# VITE_ZITADEL_CLIENT_ID is the same client ID used by the frontend dashboard.
# Local dev: generated automatically by docker-compose (`zitadel-bootstrap`) and injected at runtime.
# Shared infra/prod: set this to the same Client ID as ZITADEL_CLIENT_ID.
VITE_ZITADEL_CLIENT_ID=

# API Server
PORT=3000

# =============================================================================
# RATE LIMITING (Story 13.20)
# =============================================================================
# Backend for auth endpoint rate limiting: "memory" (default) or "redis"
# - memory: In-memory sliding window, suitable for single-instance deployments
# - redis: Redis-backed sliding window, required for multi-instance SaaS deployments
RATE_LIMIT_BACKEND=memory

# Redis URL for rate limiting (only used when RATE_LIMIT_BACKEND=redis)
# Format: redis://[:password@]host:port[/db]
# Example: redis://localhost:6379 or redis://:secretpassword@redis.example.com:6379/0
#REDIS_URL=redis://localhost:6379
