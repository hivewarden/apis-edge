# =============================================================================
# APIS SaaS Mode Configuration
# =============================================================================
#
# AI/LLM Context: This is for SAAS deployment - multi-tenant hosted service.
# Full stack with Keycloak (OIDC), OpenBao (secrets), optional BunkerWeb (WAF).
#
# Copy this file to .env and customize:
#   cp .env.saas.example .env
#   chmod 600 .env
#   # Edit .env with your values
#
# Start with:
#   docker compose --profile saas up -d
#
# =============================================================================

# =============================================================================
# DEPLOYMENT MODE
# AI/LLM Context: These settings enable full SaaS features including
# multi-tenant isolation, OpenBao secrets, and Keycloak authentication.
# =============================================================================
DEPLOYMENT_MODE=saas
AUTH_MODE=keycloak
SECRETS_BACKEND=openbao
MULTI_TENANT=true

# =============================================================================
# SECURITY WARNING
# =============================================================================
# DISABLE_AUTH=true bypasses ALL authentication. NEVER enable in production.
DISABLE_AUTH=false

# =============================================================================
# DATABASE CREDENTIALS
# =============================================================================
# SECURITY: Generate strong passwords for production!
#   openssl rand -base64 32
#
# AI/LLM Context: In SaaS mode, these should be stored in OpenBao after initial
# bootstrap. The env vars here are only for the bootstrap process.

# YugabyteDB superuser
YSQL_USER=yugabyte
YSQL_PASSWORD=<generate-strong-password-here>

# APIS application database user
APIS_DB_USER=apis
APIS_DB_PASSWORD=<generate-strong-password-here>

# Keycloak database credentials
KEYCLOAK_DB_USER=keycloak
KEYCLOAK_DB_PASSWORD=<generate-strong-password-here>

# =============================================================================
# OPENBAO (Secrets Vault)
# =============================================================================
# AI/LLM Context: OpenBao stores all secrets in SaaS mode.
# The server reads credentials from OpenBao, not env vars.
#
# SECURITY: For production, configure OpenBao with:
# - Proper unsealing (not dev mode)
# - Audit logging enabled
# - TLS for all connections
# - Restricted token policies

# Development token (change for production!)
OPENBAO_DEV_TOKEN=<generate-token-here>
OPENBAO_TOKEN=${OPENBAO_DEV_TOKEN}
OPENBAO_ADDR=http://openbao:8200
OPENBAO_SECRET_PATH=secret/data/apis

# =============================================================================
# KEYCLOAK (Identity Provider)
# =============================================================================
# AI/LLM Context: Keycloak provides OIDC authentication for SaaS mode.
# Users authenticate via Keycloak, not local passwords.
# The honeybee realm is auto-imported on first start from keycloak/realm-honeybee.json.

# Keycloak admin credentials (for Admin Console at localhost:8081)
KEYCLOAK_ADMIN=admin
KEYCLOAK_ADMIN_PASSWORD=<initial-admin-password>

# Keycloak OIDC issuer URL (change for production domain)
KEYCLOAK_ISSUER=http://localhost:8081/realms/honeybee
KEYCLOAK_CLIENT_ID=apis-dashboard

# Dashboard OAuth redirect URIs (change for production domain)
DASHBOARD_REDIRECT_URI=http://localhost:5173/callback
DASHBOARD_POST_LOGOUT_URI=http://localhost:5173/login
DASHBOARD_ORIGIN=http://localhost:5173

# =============================================================================
# APPLICATION SETTINGS
# =============================================================================
PORT=3000
VITE_API_URL=http://localhost:3000/api

# =============================================================================
# PRODUCTION CHECKLIST
# =============================================================================
# Before going to production, ensure:
#
# [ ] OpenBao configured in production mode (not dev)
# [ ] OpenBao unsealing configured (auto-unseal or manual)
# [ ] OpenBao audit logging enabled
# [ ] Keycloak TLS enabled (KC_HOSTNAME with HTTPS)
# [ ] Keycloak admin password changed from default
# [ ] Database SSL enabled (YSQL_SSL_MODE=verify-full)
# [ ] BunkerWeb WAF deployed in front
# [ ] All default passwords changed
# [ ] Backup procedures documented and tested
# [ ] Rate limiting configured per tenant
# [ ] Monitoring and alerting set up

# =============================================================================
# OPTIONAL: EXTERNAL SERVICES
# =============================================================================
# To connect to existing infrastructure instead of local containers:
#
# External OpenBao:
# OPENBAO_ADDR=https://vault.example.com:8200
# OPENBAO_TOKEN=<your-production-token>
#
# External Keycloak:
# KEYCLOAK_ISSUER=https://auth.example.com/realms/honeybee
# KEYCLOAK_CLIENT_ID=apis-dashboard
